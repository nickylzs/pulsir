This is an old part of Pulsir's code. The new version will be posted soon, we just have some tiny things to sort out, okay?
